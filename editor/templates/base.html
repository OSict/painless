<!doctype html>
<title>painless web editor</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script type="text/javascript">
function send(event, payload) {
  var request = new XMLHttpRequest();
  request.open("POST", "/" + event);
  request.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
  request.send(JSON.stringify(payload));
}

function update(p) {
  send("update", {name: p.dataset.name, value: p.value});
}

function remove(p) {
  var name = p.dataset.name;
  document.getElementById(name).remove();
  send("remove", {name: name});
}
</script>
<section class="content">
  {% if parameters|length %}
    <table class="parameter-table">
    {% for parameter in parameters %}
      <tr id="{{parameter.name}}">
        <td class="parameter-name">
          {{parameter.name}}
        </td>
        <td class="parameter-value">
          <input data-name="{{parameter.name}}" value="{{parameter.value}}" onchange="update(this)" onkeyup="update(this)" onmousedown="update(this)">
        </td>
        <td>
          <input type="button" data-name="{{parameter.name}}" onclick="remove(this)" value="❌">
        </td>
      </tr>
    {% endfor %}
  {% else %}
    No parameters found.
  {% endif %}
</section>
